// @name AnimateTransition
// @page components/transitions
// @author Tyler Benton
//
// @description
// This is how you can navigate between pages
//
// @requires js
//
// @note {!!!} - Requires `components/_transition.js`
//
// @state .transition--slide-in
// @state .transition--slide-out
// @state .transition--fade-in
// @state .transition--fade-out
// @state .transition--cover-in
// @state .transition--cover-out
// @state .transition--cover-right-in
// @state .transition--cover-right-out
// @state .transition--cover-left-in
// @state .transition--cover-left-out
// @state .transition--cover-double-in
// @state .transition--cover-double-in
// @state .transition--cover-double-out
// @state .transition--flip
// @state .transition--bounce-in
// @state .transition--bounce-out
// @state .transition--outside-in
// @state .transition--outside-out
//
// @markup (default="false")
//  <section class="{$state}">
//   <div class="section-a" data-block-state="out">
//    <span>Block 1</span>
//   </div>
//   <div class="section-b" data-block-state="in">
//    <span>Block 2</span>
//   </div>
//  </section>
//  <button class="c-btn">Next block</button>
//
// @markup {css}
//  .section-a, .section-b{
//   border-radius: 10px;
//  }
//  .section-a span, .section-b span{
//   color: #fff;
//   display: block;
//   font-size: 4em;
//   line-height: 1em;
//   padding: 1em 10px;
//   text-align: center;
//  }
//  .section-a{
//   background: #3498db;
//  }
//  .section-b{
//   background: #1abc9c;
//  }
//
// @markup {js}
//  var containers = document.querySelectorAll("[class*='transition--']");
//  for(var i = 0, l = containers.length; i < l; i++){
//       button = containers[i].nextElementSibling;
//   button.addEventListener("pointerup", function(e){
//    var obj = e.target,
//        container = obj.previousElementSibling;
//    e.preventDefault();
//    AnimateTransition({
//     container: container,
//     blockIn: "[data-block-state='in']",
//     blockOut: "[data-block-state='out']",
//     onTransitionStart: function(event){
//      obj.setAttribute("disabled", "disabled");
//     },
//     onTransitionEnd: function(event){
//      obj.removeAttribute("disabled");
//      if(this.blockOut){
//       this.blockIn.setAttribute("data-block-state", "out");
//       this.blockOut.setAttribute("data-block-state", "in");
//       this.container.appendChild(this.blockOut);
//      }
//     }
//    });
//   });
//  }
.transition-overlay{
 height: 100%;
 left: 0;
 position: fixed;
 top: 0;
 width: 100%;
 z-index: 1000;
}

%trasform-reset{
 transform: translate3d(0, 0, 0);
}

[class*="transition--"]{
 position: relative;
}

[data-block-state]{
 position: absolute;
 top: 0;
 right: 0;
 left: 0;
 bottom: 0;
 margin-top: 0;
}

[data-block-state="out"]{
 z-index: 1;
}

.to-show{
 /* overflow:auto causes screen flickering on android but changing overflow method during animation could cause flickering on iOS :) */
 overflow: visible !important;
}

.transition-block{
 backface-visibility: hidden;
 height: 100%;
 left: 0;
 overflow: hidden;
 position: absolute;
 top: 0;
 transform: translate3d(0,0,0);
 transform-style: preserve-3d;
 visibility: hidden;
 width: 100%;
}

$transition-bezier: cubic-bezier(.5, .1, .5, 1.0);

.transition{
 &--slide-in{
  @keyframes slide-in{
   from{
    transform: translate3d(0, 0, 0);
   }
   to{
    transform: translate3d(-100%, 0, 0);
   }
  }

  &.is-active{
   animation: slide-in 350ms 1 $transition-bezier;
   overflow: visible !important;
  }

  .to-show{
   transform: translate3d(100%, 0, 0);
  }

  .to-hide{
   @extend %trasform-reset;
  }
 }

 &--slide-out{
  @keyframes slide-out{
   from{
    transform: translate3d(-100%, 0, 0);
   }
   to{
    transform: translate3d(0, 0, 0);
   }
  }

  &.is-active{
   animation: slide-out 350ms 1 $transition-bezier;
   overflow: visible !important;
  }

  .to-show{
   @extend %trasform-reset;
  }

  .to-hide{
   transform: translate3d(100%, 0, 0);
  }
 }

 &--fade-in{
  @keyframes fade-in{
   from{
    opacity: 0;
   }
   to{
    opacity: 1;
   }
  }

  .to-show{
   animation: fade-in 350ms 1 $transition-bezier;
   z-index: 100;
  }

  .to-hide{
   z-index: 50;
  }
 }

 &--fade-out{
  @extend %trasform-reset;
  @keyframes fade-out{
   from{
    opacity: 1;
   }
   to{
    opacity: 0;
   }
  }

  .to-show{
   z-index: 50;
  }

  .to-hide{
   animation: fade-out 350ms 1 $transition-bezier;
   @extend %trasform-reset;
   z-index: 100;
  }
 }

 &--cover-in{
  @keyframes cover-in{
   from{
    transform: translate3d(0, 100%, 0);
   }
   to{
    transform: translate3d(0, 0, 0);
   }
  }

  &.is-active{
   overflow: hidden;
  }

  .to-show{
   animation: cover-in 400ms 1 $transition-bezier;
   z-index: 100;
  }

  .to-hide{
   @extend %trasform-reset;
   z-index: 50;
  }
 }

 &--cover-out{
  @keyframes cover-out{
   from{
    transform: translate3d(0, 0, 0);
   }
   to{
    transform: translate3d(0, 100%, 0);
   }
  }

  &.is-active{
   overflow: hidden;
  }

  .to-show{
   @extend %trasform-reset;
   z-index: 50;
  }

  .to-hide{
   animation: cover-out 400ms 1 $transition-bezier;
   z-index: 100;
  }
 }

 &--cover-right-in{
  @keyframes cover-right-in{
   from{
    transform: translate3d(100%, 0, 0);
   }
   to{
    transform: translate3d(0, 0, 0);
   }
  }

  .to-show{
   animation: cover-right-in 400ms 1 $transition-bezier;
   z-index: 100;
  }

  .to-hide{
   @extend %trasform-reset;
   z-index: 50;
  }
 }

 &--cover-right-out{
  $cover-right-out: unique-id();
  @keyframes #{$cover-right-out}{
   from{
    transform: translate3d(0, 0, 0);
   }
   to{
    transform: translate3d(125%, 0, 0);
   }
  }

  .to-show{
   @extend %trasform-reset;
   z-index: 50;
  }

  .to-hide{
   animation: $cover-right-out 400ms 1 $transition-bezier;
   transform: translate3d(125%, 0, 0);
   z-index: 100;
  }
 }

 &--cover-left-in{
  $cover-left-in: unique-id();
  @keyframes #{$cover-left-in}{
   from{
    transform: translate3d(-100%, 0, 0);
   }
   to{
    transform: translate3d(0, 0, 0);
   }
  }

  .to-show{
   animation: $cover-left-in 400ms 1 $transition-bezier;
   z-index: 100;
  }

  .to-hide{
   @extend %trasform-reset;
   z-index: 50;
  }
 }

 &--cover-left-out{
  $cover-left-out: unique-id();
  @keyframes #{$cover-left-out}{
   from{
    transform: translate3d(0, 0, 0);
   }
   to{
    transform: translate3d(-125%, 0, 0);
   }
  }

  .to-show{
   @extend %trasform-reset;
   z-index: 50;
  }

  .to-hide{
   animation: $cover-left-out 400ms 1 $transition-bezier;
   transform: translate3d(-125%, 0, 0);
   z-index: 100;
  }
 }

 &--cover-double-in{
  $cover-double-in: unique-id();
  @keyframes #{$cover-double-in}{
   from{
    transform: translate3d(100%, 0, 0);
   }
   to{
    transform: translate3d(0, 0, 0);
   }
  }
  .to-show{
   animation: $cover-double-in 400ms 1 $transition-bezier;
   z-index: 100;
  }

  .to-hide{
   background: #7f7f7f;
   filter: grayscale(1);
   @extend %trasform-reset;
   transition: background 1s ease;
   z-index: 50;
  }
 }

 &--cover-double-out{
  $cover-double-out: unique-id();
  @keyframes #{$cover-double-out}{
   from{
    transform: translate3d(-100%, 0, 0);
   }
   to{
    transform: translate3d(0, 0, 0);
   }
  }

  .to-show{
   animation: $cover-double-out 400ms 1 $transition-bezier;
   z-index: 100;
  }

  .to-hide{
   background: #7f7f7f;
   filter: grayscale(1);
   @extend %trasform-reset;
   transition: background 1s ease;
   z-index: 50;
  }
 }

 &--flip{
  $flip: unique-id();
  @keyframes #{$flip}{
   from{
    transform: rotateY(180deg);
   }
   to{
    transform: rotateY(0deg);
   }
  }

  &.is-active{
   animation: $flip 400ms 1 $transition-bezier;
   perspective: 1000;
   transform-style: preserve-3d;
  }

  .to-show{
   backface-visibility: hidden;
   transform: translate3d(0,0,0);
  }

  .to-hide{
   backface-visibility: hidden;
   transform: translate3d(0,0,0);
   transform: rotateY(180deg);
  }
 }

 &--bounce-in{
  @keyframes bounce-in{
   0%{
    opacity: 0;
    transform: scale(.3);
   }
   50%{
    opacity: 1;
    transform: scale(1.05);
   }
   70%{
    transform: scale(.9);
   }
   100%{
    opacity: 1;
    transform: scale(1);
   }
  }

  .to-show{
   animation: bounce-in 400ms 1 $transition-bezier;
   z-index: 100;
  }

  .to-hide{
   @extend %trasform-reset;
   z-index: 50;
  }
 }

 &--bounce-out{
  @keyframes bounce-out{
   0%{
    transform: scale(1);
   }
   25%{
    transform: scale(.95);
   }
   50%{
    opacity: 1;
    transform: scale(1.1);
   }
   100%{
    opacity: 0;
    transform: scale(.3);
   }
  }

  .to-show{
   @extend %trasform-reset;
   z-index: 50;
  }

  .to-hide{
   animation: bounce-out 400ms 1 $transition-bezier;
   z-index: 100;
  }
 }

 &--outside-in{
  @keyframes outside-in{
   from{
    opacity: 0;
    transform: scale(1.1);
   }
   to{
    opacity: 1;
    transform: scale(1);
   }
  }

  .to-show{
   animation: outside-in 200ms 1 $transition-bezier;
   z-index: 100;
  }

  .to-hide{
   @extend %trasform-reset;
   z-index: 50;
  }
 }

 &--outside-out{
  @keyframes outside-out{
   from{
    opacity: 1;
    transform: scale(1);
   }
   to{
    opacity: 0;
    transform: scale(1.1);
   }
  }

  .to-show{
   @extend %trasform-reset;
   z-index: 50;
  }

  .to-hide{
   animation: outside-out 200ms 1 $transition-bezier;
   z-index: 100;
  }
 }
}


.modal-container{
 background: rgba(black, .5);
 height: 100%;
 left: 0;
 position: fixed;
 top: 0;
 white-space: nowrap;
 width: 100%;
 z-index: 1000;
 &:before{
  content: "";
  display: inline-block;
  height: 100%;
  margin: 0 -1px 0 0;
  vertical-align: top;
  width: 1px;
 }

 /* dialog alignment: left top */
 &.pos-left-top{
  text-align: left;
 }

 /* dialog alignment: center top */
 &.pos-center-top{
  text-align: center;
 }

 /* dialog alignment: right top */
 &.pos-right-top{
  text-align: right;
 }

 /* dialog alignment: center center */
 &.pos-center-center{
  text-align: center;
 }

 /* dialog alignment: right center */
 &.pos-right-center{
  text-align: right;
 }

 /* dialog alignment: center bottom */
 &.pos-center-bottom{
  text-align: center;
 }

 /* dialog alignment: right bottom */
 &.pos-right-bottom{
  text-align: right;
 }
}


div[data-role="modal-view"]{
 background: #fff;
 display: inline-block;
 max-height: 100%;
 position: relative;
 text-align: left;
 vertical-align: top;
 white-space: normal;
}


/* dialog alignment: x center */
.modal-container.pos-left-center:before,
.modal-container.pos-left-center div[data-role="modal-view"],
.modal-container.pos-center-center:before,
.modal-container.pos-center-center div[data-role="modal-view"],
.modal-container.pos-right-center:before,
.modal-container.pos-right-center div[data-role="modal-view"]{
 vertical-align: middle;
}



/* dialog alignment: x bottom */
.modal-container.pos-left-bottom:before,
.modal-container.pos-left-bottom .modal-view,
.modal-container.pos-center-bottom:before,
.modal-container.pos-center-bottom .modal-view,
.modal-container.pos-right-bottom:before,
.modal-container.pos-right-bottom .modal-view{
 vertical-align: bottom;
}



.transition-popup{

}

.transition-popup-scale-in{
 animation: opacity-in 200ms 1 ease;
 @keyframes opacity-in{
  from{
   opacity: 0;
  }
  to{
   opacity: 1;
  }
 }

 .to-show{
  $to-show: unique-id();
  animation: $to-show 200ms 1 ease;
  transform-origin: 50% 50%;

  @keyframes #{$to-show}{
   from{
    transform: scale(.7);
   }
   to{
    transform: scale(1);
   }
  }
 }
}


.transition-popup-scale-out{
 animation: opacity-out 2000ms 1 ease;

 @keyframes opacity-out{
  from{
   opacity: 1;
  }
  to{
   opacity: 0;
  }
 }

 .to-hide{
  $popup-scale-out: unique-id();
  animation: $popup-scale-out 200ms 1 ease;
  transform-origin: 50% 50%;

  @keyframes #{$popup-scale-out}{
   from{
    transform: scale(1);
   }
   to{
    transform: scale(.7);
   }
  }

 }
}

.transition-popup-fade-in{
 animation: fade-in 200ms 1 ease;
}

.transition-popup-fade-out{
 animation: fade-out 200ms 1 ease;
}

.transition-popup-drop-in{
 animation: fade-in 200ms 1 ease;

 .to-show{
  $view-drop-in: unique-id();
  animation: $view-drop-in 200ms 1 ease;

  @keyframes #{$view-drop-in}{
   from{
    transform: translate3d(0, -100%, 0);
   }
   to{
    transform: translate3d(0, 0, 0);
   }
  }
 }
}

.transition-popup-drop-out{
 animation: fade-out 200ms 1 ease 50ms;

 $view-drop-out: unique-id();
 @keyframes #{$view-drop-out}{
  from{
   transform: translate3d(0, 0, 0);
  }
  to{
   transform: translate3d(0, -100%, 0);
  }
 }

 .to-show{
  animation: $view-drop-out 200ms 1 ease;
 }

 .to-hide{
  animation: $view-drop-out 250ms 1 ease;
 }
}

.transition-popup-revolution-in{
 $popup-revolution-in: unique-id();
 @keyframes #{$popup-revolution-in}{
  from{
   transform: rotateY(180deg);
  }
  to{
   transform: rotateY(0deg);
  }
 }

 .to-show{
  animation: $popup-revolution-in 200ms 1 $transition-bezier;
  backface-visibility: hidden;
  display: block;
  perspective: 1000;
  transform-style: preserve-3d;
 }
}

.transition-popup-flip{
 @keyframes popup-flip{
  from{
   opacity: .999;
  }
  to{
   opacity: .998;
  }
 }

 animation: popup-flip 200ms 1 ease 50ms;

 .to-hide{
  $view-flip: unique-id();
  @keyframes #{$view-flip}{
   from{
    transform: rotateY(0deg);
   }
   to{
    transform: rotateY(90deg);
   }
  }

  animation: $view-flip 250ms 1 ease;
 }
}